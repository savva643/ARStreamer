workflows:
  ios-xcode-workflow:
    name: iOS Build Without Signing
    environment:
      xcode: latest
      vars:
        XCODE_PROJECT: "ARStreamer.xcodeproj"
        XCODE_SCHEME: "ARStreamer"
    scripts:
      - name: Build app
        script: |
          xcodebuild build \
            -project "$XCODE_PROJECT" \
            -scheme "$XCODE_SCHEME" \
            -configuration Release \
            -derivedDataPath build

      - name: Package IPA
        script: |
          cd build/Build/Products/Release-iphoneos/
          mkdir -p Payload
          cp -r ARStreamer.app Payload/
          zip -r ARStreamer.ipa Payload

    artifacts:
      - build/Build/Products/Release-iphoneos/ARStreamer.ipa
